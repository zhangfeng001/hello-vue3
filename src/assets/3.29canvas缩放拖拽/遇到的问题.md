<!--
 * @Descripttion: 
 * @version: 
 * @Author: lzy
 * @Date: 2021-04-02 09:32:09
 * @LastEditors: Andy
 * @LastEditTime: 2021-04-02 13:56:42
-->
# canvas 拖拽缩放学习过程中遇到的问题

|索引|问题详情|问题原因|解决办法|难度系数|
|----|----|----|----|----|
|1|鼠标在canvas内部滚动滚轮进行缩放，页面跟着滚动|浏览器的默认事件|阻止默认事件e.preventDefault()|⭐⭐|
|2|右击canvas弹出浏览器默认弹窗|浏览器自带默认事件|在DOM元素添加事件@contextmenu.prevent="return false"|⭐⭐⭐|
|3|鼠标自带辅助线在鼠标划出canvas面板时，辅助线留在边边|渲染问题|在mouseOut事件里判断如果鼠标移出canvas后清除canvas并且重新绘图，辅助线不再绘制|⭐⭐⭐⭐⭐⭐|
|4|难以记录当前鼠标落在canvas的哪个元素|逻辑问题|把当前canvas上的元素用用一个array保存`（x,y,w,h）`，鼠标移动过程获取鼠标的x，y，遍历array判断x,y在哪个元素上，return出array索引`this.getEventIndex()`|⭐⭐⭐⭐⭐|
|5|鼠标进入元素，显示元素的8个可操作点混乱|逻辑问题|首先获得当前鼠标移入的元素索引index，再获取`array[index]`的八个位置坐标，并且画出微小矩形`this.drawLitRecs()`|⭐⭐⭐⭐⭐|
|6|鼠标进入可操作点，显示的鼠标样式混乱|逻辑问题|首先判断鼠标落在哪个可操作点上`this.getEventArea()`抛出不同数字代表，再进行css操作`this.changeResizeCursor()`|⭐⭐⭐⭐⭐|
|7|鼠标移动mouseMove过程辅助线与元素内容重复出现|逻辑问题|mouseMove中边清除canvas，边重新画出辅助线与元素|⭐⭐⭐⭐⭐⭐|
|8|canvas滚轮缩放后，辅助线与图案位置错乱出现|逻辑问题|mousewheel中边滚动要边记录滚出canvas视口外的距离，画出相应的辅助线或者内容需要`（视口内距离+视口外距离）/缩放数`转换|⭐⭐⭐⭐⭐⭐⭐⭐|
|9|鼠标滚动过程，中心位置跑偏|逻辑问题|使用`ctx.setTransform()`替代`ctx.translate()，ctx.scale()`;|⭐⭐⭐⭐⭐⭐|
|10|canvas滚轮缩放后，辅助线与图案位置保持正确，移动鼠标，图案再次错乱|逻辑问题|移动过程画出的包括元素，辅助线，8个可操作点，鼠标的位置，统统需要`（视口内距离+视口外距离）/缩放数`转换|⭐⭐⭐⭐⭐⭐⭐⭐|
|11|canvas滚轮缩放后，辅助线与图案位置保持正确，移动鼠标，图案再次错乱|逻辑问题|移动过程画出的包括元素，辅助线，8个可操作点，鼠标的位置，拖拽距离等等统统需要`（视口内距离+视口外距离）/缩放数`转换|⭐⭐⭐⭐⭐⭐⭐⭐|
|12|鼠标在某位置放大canvas后，更换其他位置再缩小，出现边侧内容无线重复（未解决）|逻辑问题||⭐⭐⭐⭐⭐⭐⭐⭐|
|13|右键删除某个图形后，其他图形闪现画成虚线的样式|逻辑问题|清除删除图形后，重新渲染辅助线与剩余图形`this.drawRuler(),this.drawOldRecs()`重点保证之前加上`ctx.beginPath()`避免被之前影响|⭐⭐⭐⭐⭐⭐|
|14|已经设置取消了canvas的默认右键事件后，点击canvas上的某个图案，让显示弹窗，此时右键默认事件又出来了|逻辑问题|全局添加`document.oncontextmenu = (e) => {e.preventDefault()}`|⭐⭐⭐|
